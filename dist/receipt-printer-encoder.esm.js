"use strict";
var Ce=Object.defineProperty;var ae=p=>{throw TypeError(p)};var Ee=(p,e,t)=>e in p?Ce(p,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):p[e]=t;var oe=(p,e,t)=>Ee(p,typeof e!="symbol"?e+"":e,t),G=(p,e,t)=>e.has(p)||ae("Cannot "+t);var n=(p,e,t)=>(G(p,e,"read from private field"),t?t.call(p):e.get(p)),b=(p,e,t)=>e.has(p)?ae("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(p):e.set(p,t),h=(p,e,t,r)=>(G(p,e,"write to private field"),r?r.call(p,t):e.set(p,t),t),E=(p,e,t)=>(G(p,e,"access private method"),t);import U from"canvas-dither";import Pe from"canvas-flatten";import re from"@point-of-sale/codepage-encoder";import H from"@canvas/image-data";import Be from"resize-image-data";import J from"@point-of-sale/codepage-encoder";var K=class{initialize(){return[[27,64],[28,46],[27,77,0]]}font(e){return[27,77,e.charCodeAt(0)-65]}align(e){let t;switch(e){case"center":t=1;break;case"right":t=2;break;case"left":default:t=0}return[27,97,t]}barcode(e,t,r){let l=[],s={upca:0,upce:1,ean13:2,ean8:3,code39:4,coda39:4,itf:5,"interleaved-2-of-5":5,"nw-7":6,codabar:6,code93:72,code128:73,"gs1-128":72,"gs1-databar-omni":75,"gs1-databar-truncated":76,"gs1-databar-limited":77,"gs1-databar-expanded":78,"code128-auto":79};if(typeof t=="string"&&typeof s[t]>"u")throw new Error(`Symbology '${t}' not supported by language`);if(r.width<1||r.width>3)throw new Error("Width must be between 1 and 3");let i=r.width+1;t==="itf"&&(i=r.width*2),(t==="gs1-128"||t=="gs1-databar-omni"||t=="gs1-databar-truncated"||t=="gs1-databar-limited"||t=="gs1-databar-expanded")&&(i=r.width),l.push([29,104,r.height],[29,119,i],[29,72,r.text?2:0]),t=="code128"&&!e.startsWith("{")&&(e="{B"+e),t=="gs1-128"&&(console.log("gs1-128",e,e.replace(/[\(\)\*]/g,"")),e=e.replace(/[\(\)\*]/g,""));let o=J.encode(e,"ascii"),d=typeof t=="string"?s[t]:t;return d>64?l.push([29,107,d,o.length,...o]):l.push([29,107,d,...o,0]),l}qrcode(e,t){let r=[];if(typeof t.model=="number"){let o={1:49,2:50};if(t.model in o)r.push([29,40,107,4,0,49,65,o[t.model],0]);else throw new Error("Model must be 1 or 2")}if(typeof t.size!="number")throw new Error("Size must be a number");if(t.size<1||t.size>8)throw new Error("Size must be between 1 and 8");r.push([29,40,107,3,0,49,67,t.size]);let l={l:48,m:49,q:50,h:51};if(t.errorlevel in l)r.push([29,40,107,3,0,49,69,l[t.errorlevel]]);else throw new Error("Error level must be l, m, q or h");let s=J.encode(e,"iso8859-1"),i=s.length+3;return r.push([29,40,107,i&255,i>>8&255,49,80,48,...s]),r.push([29,40,107,3,0,49,81,48]),r}pdf417(e,t){let r=[];if(typeof t.columns!="number")throw new Error("Columns must be a number");if(t.columns!==0&&(t.columns<1||t.columns>30))throw new Error("Columns must be 0, or between 1 and 30");if(r.push([29,40,107,3,0,48,65,t.columns]),typeof t.rows!="number")throw new Error("Rows must be a number");if(t.rows!==0&&(t.rows<3||t.rows>90))throw new Error("Rows must be 0, or between 3 and 90");if(r.push([29,40,107,3,0,48,66,t.rows]),typeof t.width!="number")throw new Error("Width must be a number");if(t.width<2||t.width>8)throw new Error("Width must be between 2 and 8");if(r.push([29,40,107,3,0,48,67,t.width]),typeof t.height!="number")throw new Error("Height must be a number");if(t.height<2||t.height>8)throw new Error("Height must be between 2 and 8");if(r.push([29,40,107,3,0,48,68,t.height]),typeof t.errorlevel!="number")throw new Error("Errorlevel must be a number");if(t.errorlevel<0||t.errorlevel>8)throw new Error("Errorlevel must be between 0 and 8");r.push([29,40,107,4,0,48,69,48,t.errorlevel+48]),r.push([29,40,107,3,0,48,70,t.truncated?1:0]);let l=J.encode(e,"ascii"),s=l.length+3;return r.push([29,40,107,s&255,s>>8&255,48,80,48,...l]),r.push([29,40,107,3,0,48,81,48]),r}image(e,t,r,l){let s=[],i=(m,c)=>m<t&&c<r?e.data[(t*c+m)*4]>0?0:1:0,o=(m,c)=>{let I=[];for(let C=0;C<Math.ceil(c/24);C++){let P=new Uint8Array(m*3);for(let v=0;v<m;v++)for(let S=0;S<3;S++)for(let F=0;F<8;F++)P[v*3+S]|=i(v,C*24+F+8*S)<<7-F;I.push(P)}return I},d=(m,c)=>{let I=new Uint8Array(m*c>>3);for(let C=0;C<c;C++)for(let P=0;P<m;P=P+8)for(let v=0;v<8;v++)I[C*(m>>3)+(P>>3)]|=i(P+v,C)<<7-v;return I};return l=="column"&&(s.push([27,51,36]),o(t,r).forEach(m=>{s.push([27,42,33,t&255,t>>8&255,...m,10])}),s.push([27,50])),l=="raster"&&s.push([29,118,48,0,t>>3&255,t>>3>>8&255,r&255,r>>8&255,...d(t,r)]),s}cut(e){let t=0;return e=="partial"&&(t=1),[29,86,t]}pulse(e,t,r){return typeof e>"u"&&(e=0),typeof t>"u"&&(t=100),typeof r>"u"&&(r=500),t=Math.min(500,Math.round(t/2)),r=Math.min(500,Math.round(r/2)),[27,112,e?1:0,t&255,r&255]}bold(e){let t=0;return e&&(t=1),[27,69,t]}underline(e){let t=0;return e&&(t=1),[27,45,t]}italic(e){let t=0;return e&&(t=1),[27,52,t]}invert(e){let t=0;return e&&(t=1),[29,66,t]}size(e,t){return[29,33,t-1|e-1<<4]}codepage(e){return[27,116,e]}flush(){return[]}},de=K;import Z from"@point-of-sale/codepage-encoder";var _=class{initialize(){return[27,64,24]}font(e){let t;switch(e){case"B":t=1;break;case"C":t=2;break;case"A":default:t=0}return[27,30,70,t]}align(e){let t=0;return e==="center"?t=1:e==="right"&&(t=2),[27,29,97,t]}barcode(e,t,r){let l=[],s={upce:0,upca:1,ean8:2,ean13:3,code39:4,itf:5,"interleaved-2-of-5":5,code128:6,code93:7,"nw-7":8,codabar:8,"gs1-128":9,"gs1-databar-omni":10,"gs1-databar-truncated":11,"gs1-databar-limited":12,"gs1-databar-expanded":13};if(typeof t=="string"&&typeof s[t]>"u")throw new Error(`Symbology '${t}' not supported by language`);if(r.width<1||r.width>3)throw new Error("Width must be between 1 and 3");t==="code128"&&e.startsWith("{")&&(e=e.slice(2));let i=Z.encode(e,"ascii"),o=typeof t=="string"?s[t]:t;return l.push(27,98,o,r.text?2:1,r.width,r.height,...i,30),l}qrcode(e,t){let r=[],l={1:1,2:2};if(t.model in l)r.push([27,29,121,83,48,l[t.model]]);else throw new Error("Model must be 1 or 2");if(typeof t.size!="number")throw new Error("Size must be a number");if(t.size<1||t.size>8)throw new Error("Size must be between 1 and 8");r.push([27,29,121,83,50,t.size]);let s={l:0,m:1,q:2,h:3};if(t.errorlevel in s)r.push([27,29,121,83,49,s[t.errorlevel]]);else throw new Error("Error level must be l, m, q or h");let i=Z.encode(e,"iso8859-1"),o=i.length;return r.push([27,29,121,68,49,0,o&255,o>>8&255,...i]),r.push([27,29,121,80]),r}pdf417(e,t){let r=[];if(typeof t.columns!="number")throw new Error("Columns must be a number");if(t.columns!==0&&(t.columns<1||t.columns>30))throw new Error("Columns must be 0, or between 1 and 30");if(typeof t.rows!="number")throw new Error("Rows must be a number");if(t.rows!==0&&(t.rows<3||t.rows>90))throw new Error("Rows must be 0, or between 3 and 90");if(r.push([27,29,120,83,48,1,t.rows,t.columns]),typeof t.width!="number")throw new Error("Width must be a number");if(t.width<2||t.width>8)throw new Error("Width must be between 2 and 8");if(r.push([27,29,120,83,50,t.width]),typeof t.height!="number")throw new Error("Height must be a number");if(t.height<2||t.height>8)throw new Error("Height must be between 2 and 8");if(r.push([27,29,120,83,51,t.height]),typeof t.errorlevel!="number")throw new Error("Errorlevel must be a number");if(t.errorlevel<0||t.errorlevel>8)throw new Error("Errorlevel must be between 0 and 8");r.push([27,29,120,83,49,t.errorlevel]);let l=Z.encode(e,"ascii"),s=l.length;return r.push([27,29,120,68,s&255,s>>8&255,...l]),r.push([27,29,120,80]),r}image(e,t,r,l){let s=[],i=(o,d)=>typeof e.data[(t*d+o)*4]>"u"||e.data[(t*d+o)*4]>0?0:1;s.push([27,48]);for(let o=0;o<r/24;o++){let d=o*24,m=new Uint8Array(t*3);for(let c=0;c<t;c++){let I=c*3;m[I]=i(c,d+0)<<7|i(c,d+1)<<6|i(c,d+2)<<5|i(c,d+3)<<4|i(c,d+4)<<3|i(c,d+5)<<2|i(c,d+6)<<1|i(c,d+7),m[I+1]=i(c,d+8)<<7|i(c,d+9)<<6|i(c,d+10)<<5|i(c,d+11)<<4|i(c,d+12)<<3|i(c,d+13)<<2|i(c,d+14)<<1|i(c,d+15),m[I+2]=i(c,d+16)<<7|i(c,d+17)<<6|i(c,d+18)<<5|i(c,d+19)<<4|i(c,d+20)<<3|i(c,d+21)<<2|i(c,d+22)<<1|i(c,d+23)}s.push([27,88,t&255,t>>8&255,...m,10,13])}return s.push([27,122,1]),s}cut(e){let t=0;return e=="partial"&&(t=1),[27,100,t]}pulse(e,t,r){return typeof e>"u"&&(e=0),typeof t>"u"&&(t=200),typeof r>"u"&&(r=200),t=Math.min(127,Math.round(t/10)),r=Math.min(127,Math.round(r/10)),[27,7,t&255,r&255,e?26:7]}bold(e){let t=70;return e&&(t=69),[27,t]}underline(e){let t=0;return e&&(t=1),[27,45,t]}italic(e){return[]}invert(e){let t=53;return e&&(t=52),[27,t]}size(e,t){return[27,105,t-1,e-1]}codepage(e){return[27,29,116,e]}flush(){return[[27,29,80,48],[27,29,80,49]]}},ue=_;var D,f,k,ee=class{constructor(e){b(this,D,{bold:!1,italic:!1,underline:!1,invert:!1,width:1,height:1});b(this,f);b(this,k);h(this,f,structuredClone(n(this,D))),h(this,k,e.callback||(()=>{}))}store(){let e=[];for(let t in n(this,f)){let r=t,l=n(this,f)[r],s=n(this,D)[r];l!==s&&(r==="width"||r==="height"?e.push({type:"style",property:"size",value:{width:s,height:s}}):e.push({type:"style",property:r,value:s}))}return e}restore(){let e=[];for(let t in n(this,f)){let r=t,l=n(this,f)[r],s=n(this,D)[r];l!==s&&(r==="width"||r==="height"?e.push({type:"style",property:"size",value:{width:l,height:l}}):e.push({type:"style",property:r,value:l}))}return e}set bold(e){e!==n(this,f).bold&&(n(this,f).bold=e,n(this,k).call(this,{type:"style",property:"bold",value:e}))}get bold(){return n(this,f).bold}set italic(e){e!==n(this,f).italic&&(n(this,f).italic=e,n(this,k).call(this,{type:"style",property:"italic",value:e}))}get italic(){return n(this,f).italic}set underline(e){e!==n(this,f).underline&&(n(this,f).underline=e,n(this,k).call(this,{type:"style",property:"underline",value:e}))}get underline(){return n(this,f).underline}set invert(e){e!==n(this,f).invert&&(n(this,f).invert=e,n(this,k).call(this,{type:"style",property:"invert",value:e}))}get invert(){return n(this,f).invert}set width(e){e!==n(this,f).width&&(n(this,f).width=e,n(this,k).call(this,{type:"style",property:"size",value:{width:n(this,f).width,height:n(this,f).height}}))}get width(){return n(this,f).width}set height(e){e!==n(this,f).height&&(n(this,f).height=e,n(this,k).call(this,{type:"style",property:"size",value:{width:n(this,f).width,height:n(this,f).height}}))}get height(){return n(this,f).height}};D=new WeakMap,f=new WeakMap,k=new WeakMap;var ce=ee;var te=class{static wrap(e,t){let r=[],l=[],s=t.indent||0,i=t.width||1,o=t.columns||42,d=String(e).split(/\r\n|\n/g);for(let c of d){let I=c.match(/[^\s-]+?-\b|\S+|\s+|\r\n?|\n/g)||["~~empty~~"];for(let C of I){if(C==="~~empty~~"){r.push(l),l=[],s=0;continue}if(s+C.length*i>o){if(C.length*i>o){let P=o-s,v=C.split(""),S,F=[];for(P>8*i&&(S=v.splice(0,Math.floor(P/i)).join(""),l.push(S),r.push(l),l=[],s=0);(S=v.splice(0,Math.floor(o/i))).length;)F.push(S.join(""));for(let Y of F)s+Y.length*i>o&&(r.push(l),l=[],s=0),l.push(Y),s+=Y.length*i;continue}r.push(l),l=[],s=0}C.match(/\s+/)&&s==0||(l.push(C),s+=C.length*i)}l.length>0&&(r.push(l),l=[],s=0)}let m=[];for(let c=0;c<r.length;c++){let I=r[c].join("");c<r.length-1&&(I=I.trimEnd()),m.push(I)}return m}},pe=te;var ze=p=>Array.isArray(p)&&p.length>0&&Array.isArray(p[0]),Ie=p=>p.type==="text",Ae=p=>p.type==="space";var he=p=>p.type==="align",me=p=>p.type==="style";var Q,A,B,W,y,M,x,j,V,ne=class{constructor(e){b(this,j);oe(this,"style");b(this,Q);b(this,A);b(this,B);b(this,W);b(this,y,0);b(this,M);b(this,x,[]);h(this,Q,e.embedded||!1),h(this,A,e.columns||42),h(this,B,e.align||"left"),h(this,W,e.callback||(()=>{})),this.style=new ce({callback:t=>{this.add(t,0)}}),h(this,M,this.style.store())}text(e,t){let r=pe.wrap(e,{columns:n(this,A),width:this.style.width,indent:n(this,y)});for(let l=0;l<r.length;l++)r[l].length?(this.add({type:"text",value:r[l],codepage:t},r[l].length*this.style.width),l<r.length-1&&this.flush()):this.flush({forceNewline:!0})}space(e){this.add({type:"space",size:e},e)}raw(e,t){if(ze(e))for(let r of e)this.add({type:"raw",value:r},t||0);else this.add({type:"raw",value:e},t||0)}add(e,t){t+n(this,y)>n(this,A)&&this.flush(),h(this,y,n(this,y)+t),h(this,x,n(this,x).concat(Array.isArray(e)?e:[e]))}end(){h(this,y,n(this,A))}fetch(e){if(n(this,y)===0&&!e.forceNewline&&!e.forceFlush)return[];let t={current:n(this,B),next:null};for(let i=0;i<n(this,x).length-1;i++){let o=n(this,x)[i];he(o)&&(t.current=o.value)}if(n(this,x).length){let i=n(this,x)[n(this,x).length-1];i.type==="align"&&(t.next=i.value)}h(this,B,t.current);let r=[],l=this.style.restore(),s=this.style.store();if(n(this,y)===0&&e.ignoreAlignment)r=E(this,j,V).call(this,[...n(this,M),...n(this,x),...s]);else{if(n(this,B)==="right"){let i;for(let o=n(this,x).length-1;o>=0;o--)if(n(this,x)[o].type==="text"||n(this,x)[o].type==="space"){i=o;break}if(typeof i=="number"){let o=n(this,x)[i];Ae(o)&&o.size>this.style.width&&(o.size-=this.style.width,h(this,y,n(this,y)-this.style.width)),Ie(o)&&o.value.endsWith(" ")&&(o.value=o.value.slice(0,-1),h(this,y,n(this,y)-this.style.width))}r=E(this,j,V).call(this,[{type:"space",size:n(this,A)-n(this,y)},...n(this,M),...n(this,x),...s])}if(n(this,B)==="center"){let i=n(this,A)-n(this,y)>>1;r=E(this,j,V).call(this,[{type:"space",size:i},...n(this,M),...n(this,x),...s,{type:"space",size:n(this,Q)?n(this,A)-n(this,y)-i:0}])}n(this,B)==="left"&&(r=E(this,j,V).call(this,[...n(this,M),...n(this,x),...s,{type:"space",size:n(this,Q)?n(this,A)-n(this,y):0}]))}return h(this,M,l),h(this,x,[]),h(this,y,0),r.length===0&&e.forceNewline&&r.push({type:"empty"}),t.next&&h(this,B,t.next),r}flush(e){e=Object.assign({forceNewline:!1,forceFlush:!1,ignoreAlignment:!1},e||{});let t=this.fetch(e);t.length&&n(this,W).call(this,t)}get cursor(){return n(this,y)}set align(e){this.add({type:"align",value:e},0)}get align(){let e=n(this,B);for(let t=0;t<n(this,x).length;t++){let r=n(this,x)[t];he(r)&&(e=r.value)}return e}set columns(e){h(this,A,e)}get columns(){return n(this,A)}};Q=new WeakMap,A=new WeakMap,B=new WeakMap,W=new WeakMap,y=new WeakMap,M=new WeakMap,x=new WeakMap,j=new WeakSet,V=function(e){let t=[],r=-1;function l(s){return s.type==="text"}for(let s of e)if(s.type==="space"&&"size"in s&&s.size>0&&(s={type:"text",value:" ".repeat(s.size),codepage:null}),l(s)){let i=t[r];if(r>=0&&l(i)&&(i.codepage===s.codepage||i.codepage===null||s.codepage===null)){i.value+=s.value,i.codepage=i.codepage||s.codepage;continue}t.push(s),r++}else if(me(s)&&s.property==="size"){let i=t[r];if(r>=0&&me(i)&&i.property==="size"){i.value=s.value;continue}t.push(s),r++}else(s.type==="style"||s.type==="raw")&&(t.push(s),r++);return t};var fe=ne;var ve={"esc-pos":{"bixolon/legacy":["cp437","epson/katakana","cp850","cp860","cp863","cp865",null,null,null,null,null,null,null,null,null,null,null,null,null,"cp858"],bixolon:["cp437","epson/katakana","cp850","cp860","cp863","cp865",null,null,null,null,null,null,null,null,null,null,"windows1252","cp866","cp852","cp858",null,"cp862","cp864","thai42","windows1253","windows1254","windows1257",null,"windows1251","cp737","cp775","thai14","bixolon/hebrew","windows1255","thai11","thai18","cp885","cp857","iso8859-7","thai16","windows1256","windows1258","khmer",null,null,null,"bixolon/cp866","windows1250",null,"tcvn3","tcvn3capitals","viscii"],citizen:["cp437","epson/katakana","cp858","cp860","cp863","cp865","cp852","cp866","cp857",null,null,null,null,null,null,null,"windows1252",null,null,null,null,"thai11",null,null,null,null,"thai13",null,null,null,"tcvn3","tcvn3capitals","windows1258",null,null,null,null,null,null,null,"cp864"],"epson/legacy":["cp437","epson/katakana","cp850","cp860","cp863","cp865",null,null,null,null,null,null,null,null,null,null,"windows1252","cp866","cp852","cp858"],epson:["cp437","epson/katakana","cp850","cp860","cp863","cp865",null,null,null,null,null,"cp851","cp853","cp857","cp737","iso8859-7","windows1252","cp866","cp852","cp858","thai42","thai11",null,null,null,null,"thai13",null,null,null,"tcvn3","tcvn3capitals","cp720","cp775","cp855","cp861","cp862","cp864","cp869","epson/iso8859-2","iso8859-15","cp1098","cp774","cp772","cp1125","windows1250","windows1251","windows1253","windows1254","windows1255","windows1256","windows1257","windows1258","rk1048"],fujitsu:["cp437","epson/katakana","cp850","cp860","cp863","cp865",null,null,"cp857",null,null,null,null,null,null,null,"windows1252","cp866","cp852","cp858",null,null,null,null,null,null,"thai13",null,null,null,null,null,null,null,null,null,null,null,null,null,"cp864"],hp:["cp437","cp850","cp852","cp860","cp863","cp865","cp858","cp866","windows1252","cp862","cp737","cp874","cp857","windows1251","windows1255","rk1048"],metapace:["cp437","epson/katakana","cp850","cp860","cp863","cp865",null,null,null,null,null,null,null,null,null,null,null,null,null,"cp858"],mpt:["cp437",null,"cp850","cp860","cp863","cp865","windows1251","cp866","cp3021","cp3012"],"pos-5890":["cp437","epson/katakana","cp850","cp860","cp863","cp865","iso8859-1",null,"cp862",null,null,null,null,null,null,null,"windows1252","cp866","cp852","cp858",null,null,null,"windows1251","cp737","windows1257",null,"windows1258","cp864",null,null,null,"windows1255",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"cp861",null,null,null,"cp855","cp857",null,null,null,"cp851","cp869",null,"cp772","cp774",null,null,"windows1250",null,"cp3840",null,"cp3843","cp3844","cp3845","cp3846","cp3847","cp3848",null,"cp771","cp3001","cp3002","cp3011","cp3012",null,"cp3041","windows1253","windows1254","windows1256","cp720",null,"cp775"],"pos-8360":["cp437","epson/katakana","cp850","cp860","cp863","cp865","iso8859-1","windows1253","cp862",null,null,null,null,null,null,null,"windows1252","cp866","cp852","cp858",null,"latvian",null,"windows1251","cp737","windows1257",null,"windows1258","cp864",null,null,"pos8360/hebrew","windows1255",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"cp861",null,null,null,"cp855","cp857",null,null,null,"cp851","cp869",null,"cp772","cp774",null,null,"windows1250",null,"cp3840",null,"cp3843","cp3844","cp3845","cp3846","cp3847","cp3848",null,"cp771","cp3001","cp3002","cp3011","cp3012",null,null,null,"windows1254","windows1256","cp720",null,"cp775"],star:["cp437","star/katakana","cp850","cp860","cp863","cp865",null,null,null,null,null,null,null,null,null,null,"windows1252","cp866","cp852","cp858","thai42","thai11","thai13","thai14","thai16",null,"thai18"],xprinter:["cp437","epson/katakana","cp850","cp860","cp863","cp865","iso8859-1","windows1253","xprinter/hebrew","cp3012",null,"windows1255",null,null,null,null,"windows1252","cp866","cp852","cp858",null,"latvian","cp864","windows1251","cp737","windows1257",null,null,null,null,null,null,null,"windows1256"],youku:["cp437","epson/katakana","cp850","cp860","cp863","cp865","windows1251","cp866","cp3021","cp3012",null,null,null,null,null,"cp862","windows1252",null,"cp852","cp858",null,null,"cp864","iso8859-1","cp737","windows1257",null,null,"cp855","cp857","windows1250","cp775","windows1254","windows1255","windows1256","windows1258",null,null,"iso8859-1",null,null,null,null,null,"iso8859-15",null,null,"cp874"],zijang:["cp437","epson/katakana","cp850","cp860","cp863","cp865","iso8859-1",null,"cp862",null,null,null,null,null,null,null,"windows1252","cp866","cp852","cp858",null,null,null,"windows1251","cp737","windows1257",null,"windows1258","cp864",null,null,null,"windows1255",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"cp861",null,null,null,"cp855","cp857",null,null,null,"cp851","cp869",null,"cp772","cp774",null,null,"windows1250",null,"cp3840",null,"cp3843","cp3844","cp3845","cp3846","cp3847","cp3848",null,"cp771","cp3001","cp3002","cp3011","cp3012",null,"cp3041","windows1253","windows1254","windows1256","cp720",null,"cp775"]},"star-prnt":{star:["star/standard","cp437","star/katakana",null,"cp858","cp852","cp860","cp861","cp863","cp865","cp866","cp855","cp857","cp862","cp864","cp737","cp851","cp869","star/cp928","cp772","cp774","star/cp874",null,null,null,null,null,null,null,null,null,null,"windows1252","windows1250","windows1251",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"cp3840","cp3841","cp3843","cp3844","cp3845","cp3846","cp3847","cp3848","cp1001","cp771","cp3001","cp3002","cp3011","cp3012","cp3021","cp3041"]},"star-line":{star:["star/standard","cp437","star/katakana",null,"cp858","cp852","cp860","cp861","cp863","cp865","cp866","cp855","cp857","cp862","cp864","cp737","cp851","cp869","star/cp928","cp772","cp774","star/cp874",null,null,null,null,null,null,null,null,null,null,"windows1252","windows1250","windows1251",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"cp3840","cp3841","cp3843","cp3844","cp3845","cp3846","cp3847","cp3848","cp1001","cp771","cp3001","cp3002","cp3011","cp3012","cp3021","cp3041"]}},ge=ve;var Te={"bixolon-srp350":{vendor:"Bixolon",model:"SRP-350",media:{dpi:180,width:80},capabilities:{language:"esc-pos",codepages:"bixolon/legacy",fonts:{A:{size:"12x24",columns:42},B:{size:"9x17",columns:56}},barcodes:{supported:!0,symbologies:["upca","upce","ean13","ean8","code39","itf","codabar","code93","code128"]},qrcode:{supported:!1,models:[]},pdf417:{supported:!1},cutter:{feed:4}}},"bixolon-srp350iii":{vendor:"Bixolon",model:"SRP-350III",media:{dpi:180,width:80},capabilities:{language:"esc-pos",codepages:"bixolon",fonts:{A:{size:"12x24",columns:42},B:{size:"9x17",columns:56},C:{size:"9x24",columns:56}},barcodes:{supported:!0,symbologies:["upca","upce","ean13","ean8","code39","itf","codabar","code93","code128"]},qrcode:{supported:!0,models:["2"]},pdf417:{supported:!0},cutter:{feed:4}}},"citizen-ct-s310ii":{vendor:"Citizen",model:"CT-S310II",media:{dpi:203,width:80},capabilities:{language:"esc-pos",codepages:"citizen",fonts:{A:{size:"12x24",columns:48},B:{size:"9x24",columns:64},C:{size:"8x16",columns:72}},barcodes:{supported:!0,symbologies:["upca","upce","ean13","ean8","code39","itf","codabar","code93","code128","gs1-databar-omni","gs1-databar-truncated","gs1-databar-limited","gs1-databar-expanded"]},qrcode:{supported:!0,models:["1","2"]},pdf417:{supported:!0},cutter:{feed:3}}},"epson-tm-p20ii":{vendor:"Epson",model:"TM-P20II",media:{dpi:203,width:58},capabilities:{language:"esc-pos",codepages:"epson",fonts:{A:{size:"12x24",columns:32},B:{size:"9x24",columns:42},C:{size:"9x17",columns:42},D:{size:"10x24",columns:38},E:{size:"8x16",columns:48}},barcodes:{supported:!0,symbologies:["upca","upce","ean13","ean8","code39","itf","codabar","code93","code128","gs1-databar-omni","gs1-databar-truncated","gs1-databar-limited","gs1-databar-expanded","code128-auto"]},qrcode:{supported:!0,models:["1","2"]},pdf417:{supported:!0},images:{mode:"raster"},cutter:{feed:3}}},"epson-tm-t20iii":{vendor:"Epson",model:"TM-T20III",interfaces:{usb:{productName:"TM-T20III"}},media:{dpi:203,width:80},capabilities:{language:"esc-pos",codepages:"epson",fonts:{A:{size:"12x24",columns:48},B:{size:"9x17",columns:64}},barcodes:{supported:!0,symbologies:["upca","upce","ean13","ean8","code39","itf","codabar","code93","code128","gs1-databar-omni","gs1-databar-truncated","gs1-databar-limited","gs1-databar-expanded"]},qrcode:{supported:!0,models:["1","2"]},pdf417:{supported:!0},cutter:{feed:4}}},"epson-tm-t70":{vendor:"Epson",model:"TM-T70",media:{dpi:180,width:80},capabilities:{language:"esc-pos",codepages:"epson/legacy",fonts:{A:{size:"12x24",columns:42},B:{size:"9x17",columns:56}},barcodes:{supported:!0,symbologies:["upca","upce","ean13","ean8","code39","itf","codabar","code93","code128"]},qrcode:{supported:!0,models:["1","2"]},pdf417:{supported:!0},images:{mode:"raster"},cutter:{feed:4}}},"epson-tm-t70ii":{vendor:"Epson",model:"TM-T70II",interface:{usb:{productName:"TM-T70II"}},media:{dpi:180,width:80},capabilities:{language:"esc-pos",codepages:"epson",fonts:{A:{size:"12x24",columns:42},B:{size:"9x17",columns:56}},barcodes:{supported:!0,symbologies:["upca","upce","ean13","ean8","code39","itf","codabar","code93","code128","gs1-databar-omni","gs1-databar-truncated","gs1-databar-limited","gs1-databar-expanded"]},qrcode:{supported:!0,models:["1","2"]},pdf417:{supported:!0},images:{mode:"raster"},cutter:{feed:4}}},"epson-tm-t88ii":{vendor:"Epson",model:"TM-T88II",media:{dpi:180,width:80},capabilities:{language:"esc-pos",codepages:"epson/legacy",fonts:{A:{size:"12x24",columns:42},B:{size:"9x17",columns:56}},barcodes:{supported:!0,symbologies:["upca","upce","ean13","ean8","code39","itf","codabar","code93","code128"]},qrcode:{supported:!0,models:["1","2"]},pdf417:{supported:!0},cutter:{feed:4}}},"epson-tm-t88iii":{vendor:"Epson",model:"TM-T88III",media:{dpi:180,width:80},capabilities:{language:"esc-pos",codepages:"epson/legacy",fonts:{A:{size:"12x24",columns:42},B:{size:"9x17",columns:56}},barcodes:{supported:!0,symbologies:["upca","upce","ean13","ean8","code39","itf","codabar","code93","code128"]},qrcode:{supported:!0,models:["1","2"]},pdf417:{supported:!0},cutter:{feed:4}}},"epson-tm-t88iv":{vendor:"Epson",model:"TM-T88IV",media:{dpi:180,width:80},capabilities:{language:"esc-pos",codepages:"epson/legacy",fonts:{A:{size:"12x24",columns:42},B:{size:"9x17",columns:56}},barcodes:{supported:!0,symbologies:["upca","upce","ean13","ean8","code39","itf","codabar","code93","code128"]},qrcode:{supported:!0,models:["1","2"]},pdf417:{supported:!0},cutter:{feed:4}}},"epson-tm-t88v":{vendor:"Epson",model:"TM-T88V",media:{dpi:180,width:80},capabilities:{language:"esc-pos",codepages:"epson",fonts:{A:{size:"12x24",columns:42},B:{size:"9x17",columns:56}},barcodes:{supported:!0,symbologies:["upca","upce","ean13","ean8","code39","itf","codabar","code93","code128","gs1-databar-omni","gs1-databar-truncated","gs1-databar-limited","gs1-databar-expanded"]},qrcode:{supported:!0,models:["1","2"]},pdf417:{supported:!0},cutter:{feed:4}}},"epson-tm-t88vi":{vendor:"Epson",model:"TM-T88VI",media:{dpi:180,width:80},capabilities:{language:"esc-pos",codepages:"epson",fonts:{A:{size:"12x24",columns:42},B:{size:"9x17",columns:56}},barcodes:{supported:!0,symbologies:["upca","upce","ean13","ean8","code39","itf","codabar","code93","code128","gs1-databar-omni","gs1-databar-truncated","gs1-databar-limited","gs1-databar-expanded"]},qrcode:{supported:!0,models:["1","2"]},pdf417:{supported:!0},cutter:{feed:4}}},"epson-tm-t88vii":{vendor:"Epson",model:"TM-T88VII",media:{dpi:180,width:80},capabilities:{language:"esc-pos",codepages:"epson",fonts:{A:{size:"12x24",columns:42},B:{size:"9x17",columns:56}},barcodes:{supported:!0,symbologies:["upca","upce","ean13","ean8","code39","itf","codabar","code93","code128","gs1-databar-omni","gs1-databar-truncated","gs1-databar-limited","gs1-databar-expanded","code128-auto"]},qrcode:{supported:!0,models:["1","2"]},pdf417:{supported:!0},cutter:{feed:4}}},"fujitsu-fp1000":{vendor:"Fujitsu",model:"FP-1000",media:{dpi:203,width:80},capabilities:{language:"esc-pos",codepages:"fujitsu",fonts:{A:{size:"12x24",columns:48},B:{size:"9x24",columns:56},C:{size:"8x16",columns:64}},barcodes:{supported:!0,symbologies:["upca","upce","ean13","ean8","code39","itf","codabar","code93","code128","gs1-databar-omni","gs1-databar-truncated","gs1-databar-limited","gs1-databar-expanded"]},qrcode:{supported:!0,models:["1","2"]},pdf417:{supported:!1},cutter:{feed:4}}},"hp-a779":{vendor:"HP",model:"A779",media:{dpi:180,width:80},capabilities:{language:"esc-pos",codepages:"hp",newline:`
`,fonts:{A:{size:"12x24",columns:44}},barcodes:{supported:!0,symbologies:["upca","upce","ean13","ean8","code39","itf","codabar","code93","code128"]},qrcode:{supported:!0,models:["1","2"]},pdf417:{supported:!1,fallback:{type:"barcode",symbology:75}},cutter:{feed:4}}},"metapace-t1":{vendor:"Metapace",model:"T-1",media:{dpi:180,width:80},capabilities:{language:"esc-pos",codepages:"metapace",fonts:{A:{size:"12x24",columns:42},B:{size:"9x17",columns:56}},barcodes:{supported:!0,symbologies:["upca","upce","ean13","ean8","code39","itf","codabar","code93","code128"]},qrcode:{supported:!1,models:[]},pdf417:{supported:!1},cutter:{feed:4}}},"mpt-ii":{vendor:"",model:"MPT-II",media:{dpi:180,width:80},capabilities:{language:"esc-pos",codepages:"mpt",fonts:{A:{size:"12x24",columns:48},B:{size:"9x17",columns:64},C:{size:"0x0",columns:64}},barcodes:{supported:!0,symbologies:["upca","upce","ean13","ean8","code39","itf","codabar","code93","code128"]},qrcode:{supported:!0,models:[]},pdf417:{supported:!1}}},"pos-5890":{vendor:"",model:"POS-5890",media:{dpi:203,width:58},capabilities:{language:"esc-pos",codepages:"pos-5890",fonts:{A:{size:"12x24",columns:32},B:{size:"9x17",columns:42}},barcodes:{supported:!0,symbologies:["upca","ean13","ean8","code39","itf","codabar","code93","code128"]},qrcode:{supported:!0,models:["2"]},pdf417:{supported:!0},images:{mode:"raster"},cutter:{feed:1}}},"pos-8360":{vendor:"",model:"POS-8360",media:{dpi:203,width:80},capabilities:{language:"esc-pos",codepages:"pos-8360",fonts:{A:{size:"12x24",columns:48},B:{size:"9x17",columns:64}},barcodes:{supported:!0,symbologies:["upca","ean13","ean8","code39","itf","codabar","code93","code128"]},qrcode:{supported:!0,models:["2"]},pdf417:{supported:!0},images:{mode:"raster"},cutter:{feed:4}}},"star-mc-print2":{vendor:"Star",model:"mC-Print2",interfaces:{usb:{productName:"mC-Print2"}},media:{dpi:203,width:58},capabilities:{language:"star-prnt",codepages:"star",fonts:{A:{size:"12x24",columns:32},B:{size:"9x24",columns:42}},barcodes:{supported:!0,symbologies:["upca","upce","ean13","ean8","itf","codabar","code93","code128","gs1-128","gs1-databar-omni","gs1-databar-truncated","gs1-databar-limited","gs1-databar-expanded"]},qrcode:{supported:!0,models:["1","2"]},pdf417:{supported:!0},cutter:{feed:3}}},"star-mpop":{vendor:"Star",model:"mPOP",interfaces:{usb:{productName:"mPOP"}},media:{dpi:203,width:58},capabilities:{language:"star-prnt",codepages:"star",fonts:{A:{size:"12x24",columns:32},B:{size:"9x24",columns:42}},barcodes:{supported:!0,symbologies:["upca","upce","ean13","ean8","itf","codabar","code93","code128","gs1-128","gs1-databar-omni","gs1-databar-truncated","gs1-databar-limited","gs1-databar-expanded"]},qrcode:{supported:!0,models:["1","2"]},pdf417:{supported:!0},cutter:{feed:3}}},"star-sm-l200":{vendor:"Star",model:"SM-L200",media:{dpi:203,width:58},capabilities:{language:"star-prnt",codepages:"star",fonts:{A:{size:"12x24",columns:32},B:{size:"9x24",columns:42},C:{size:"9x17",columns:42}},barcodes:{supported:!0,symbologies:["upca","upce","ean13","ean8","itf","codabar","code93","code128"]},qrcode:{supported:!0,models:["2"]},pdf417:{supported:!0}}},"star-tsp100iii":{vendor:"Star",model:"TSP100III",media:{dpi:203,width:80},capabilities:{language:"star-prnt",codepages:"star",fonts:{A:{size:"12x24",columns:48},B:{size:"9x24",columns:64}},barcodes:{supported:!0,symbologies:["upca","upce","ean13","ean8","code39","itf","codabar","code93","code128"]},qrcode:{supported:!0,models:["1","2"]},pdf417:{supported:!0},cutter:{feed:3}}},"star-tsp100iv":{vendor:"Star",model:"TSP100IV",media:{dpi:203,width:80},capabilities:{language:"star-prnt",codepages:"star",fonts:{A:{size:"12x24",columns:48},B:{size:"9x24",columns:64}},barcodes:{supported:!0,symbologies:["upca","upce","ean13","ean8","code39","itf","codabar","code93","code128","gs1-128","gs1-databar-omni","gs1-databar-truncated","gs1-databar-limited","gs1-databar-expanded"]},qrcode:{supported:!0,models:["1","2"]},pdf417:{supported:!0},cutter:{feed:3}}},"star-tsp650":{vendor:"Star",model:"TSP650",media:{dpi:203,width:80},capabilities:{language:"star-line",codepages:"star",fonts:{A:{size:"12x24",columns:48},B:{size:"9x24",columns:64}},barcodes:{supported:!0,symbologies:["upca","upce","ean13","ean8","code39","itf","codabar","code93","code128"]},qrcode:{supported:!1,models:[]},pdf417:{supported:!1},cutter:{feed:3}}},"star-tsp650ii":{vendor:"Star",model:"TSP650II",media:{dpi:203,width:80},capabilities:{language:"star-line",codepages:"star",fonts:{A:{size:"12x24",columns:48},B:{size:"9x24",columns:64}},barcodes:{supported:!0,symbologies:["upca","upce","ean13","ean8","code39","itf","codabar","code93","code128","gs1-128","gs1-databar-omni","gs1-databar-truncated","gs1-databar-limited","gs1-databar-expanded"]},qrcode:{supported:!0,models:["1","2"]},pdf417:{supported:!0},cutter:{feed:3}}},"xprinter-xp-n160ii":{vendor:"Xprinter",model:"XP-N160II",interfaces:{usb:{productName:"Printer-80\0"}},media:{dpi:203,width:80},capabilities:{language:"esc-pos",codepages:"xprinter",fonts:{A:{size:"12x24",columns:48},B:{size:"9x17",columns:64}},barcodes:{supported:!0,symbologies:["upca","upce","ean13","ean8","code39","itf","codabar","code93","code128","gs1-128"]},qrcode:{supported:!0,models:["2"]},pdf417:{supported:!0},cutter:{feed:4}}},"xprinter-xp-t80q":{vendor:"Xprinter",model:"XP-T80Q",media:{dpi:203,width:80},capabilities:{language:"esc-pos",codepages:"xprinter",fonts:{A:{size:"12x24",columns:48},B:{size:"9x17",columns:64}},barcodes:{supported:!0,symbologies:["upca","upce","ean13","ean8","code39","itf","codabar","code93","code128","gs1-128"]},qrcode:{supported:!0,models:["2"]},pdf417:{supported:!0},cutter:{feed:4}}},"youku-58t":{vendor:"Youku",model:"58T",media:{dpi:203,width:58},capabilities:{language:"esc-pos",codepages:"youku",fonts:{A:{size:"12x24",columns:32},B:{size:"9x24",columns:42}},barcodes:{supported:!0,symbologies:["upca","ean13","ean8","code39","itf","codabar","code93","code128"]},qrcode:{supported:!0,models:["2"]},pdf417:{supported:!1}}}},be=Te;var se=be,xe=ge,X={columns:42,language:"esc-pos",imageMode:"column",feedBeforeCut:0,newline:`
\r`,codepageMapping:"epson",debug:!1,embedded:!1,createCanvas:null,errors:"relaxed"},u,q,g,a,w,T,N,R,O,z,le,we,ye,L,$=class ${constructor(e){b(this,z);b(this,u,X);b(this,q,[]);b(this,g);b(this,a);b(this,w,{language:X.language,codepages:X.codepageMapping,fonts:{A:{size:"12x24",columns:42},B:{size:"9x24",columns:56}},barcodes:{supported:!0,symbologies:["upca","upce","ean13","ean8","code39","itf","codabar","code93","code128","gs1-databar-omni","gs1-databar-truncated","gs1-databar-limited","gs1-databar-expanded"]},qrcode:{supported:!0,models:["1","2"]},pdf417:{supported:!0}});b(this,T);b(this,N);b(this,R,"cp437");b(this,O,{codepage:0,font:"A"});e=e||{};let t={...X};if(typeof e.language=="string"&&(t.columns=e.language==="esc-pos"?42:48,t.codepageMapping=e.language==="esc-pos"?"epson":"star"),typeof e.printerModel=="string"){if(typeof se[e.printerModel]>"u")throw new Error("Unknown printer model");h(this,w,se[e.printerModel].capabilities),t.columns=n(this,w).fonts.A.columns,t.language=n(this,w).language,t.codepageMapping=n(this,w).codepages||t.codepageMapping,t.newline=n(this,w)?.newline||t.newline,t.feedBeforeCut=n(this,w)?.cutter?.feed||t.feedBeforeCut,t.imageMode=n(this,w)?.images?.mode||t.imageMode}if(e&&h(this,u,Object.assign(t,e)),n(this,u).width&&(n(this,u).columns=n(this,u).width),n(this,u).language==="esc-pos")h(this,g,new de);else if(n(this,u).language==="star-prnt"||n(this,u).language==="star-line")h(this,g,new ue);else throw new Error("The specified language is not supported");if(typeof n(this,u).autoFlush>"u"&&(n(this,u).autoFlush=!n(this,u).embedded&&n(this,u).language=="star-prnt"),![32,35,42,44,48].includes(n(this,u).columns)&&!n(this,u).embedded)throw new Error("The width of the paper must me either 32, 35, 42, 44 or 48 columns");if(typeof n(this,u).codepageMapping=="string"){if(typeof xe[n(this,u).language][n(this,u).codepageMapping]>"u")throw new Error("Unknown codepage mapping");h(this,T,Object.fromEntries(xe[n(this,u).language][n(this,u).codepageMapping].map((r,l)=>[r,l]).filter(r=>r)))}else h(this,T,n(this,u).codepageMapping);n(this,u).codepageCandidates?h(this,N,n(this,u).codepageCandidates):h(this,N,Object.keys(n(this,T))),h(this,a,new fe({embedded:n(this,u).embedded,columns:n(this,u).columns,align:"left",callback:r=>n(this,q).push(r)})),E(this,z,le).call(this)}initialize(){if(n(this,u).embedded)throw new Error("Initialize is not supported in table cells or boxes");return n(this,a).raw(n(this,g).initialize()),this}codepage(e){if(e==="auto")return h(this,R,e),this;if(!re.supports(e))throw new Error("Unknown codepage");if(typeof n(this,T)[e]<"u")h(this,R,e);else throw new Error("Codepage not supported by printer");return this}text(e){return n(this,a).text(e,n(this,R)),this}newline(e=1){typeof e=="string"&&(e=parseInt(e,10)||1);for(let t=0;t<e;t++)n(this,a).flush({forceNewline:!0});return this}line(e){return this.text(e),this.newline(),this}underline(e){return typeof e>"u"?n(this,a).style.underline=!n(this,a).style.underline:n(this,a).style.underline=e,this}italic(e){return typeof e>"u"?n(this,a).style.italic=!n(this,a).style.italic:n(this,a).style.italic=e,this}bold(e){return typeof e>"u"?n(this,a).style.bold=!n(this,a).style.bold:n(this,a).style.bold=e,this}invert(e){return typeof e>"u"?n(this,a).style.invert=!n(this,a).style.invert:n(this,a).style.invert=e,this}width(e){if(typeof e>"u"&&(e=1),typeof e!="number")throw new Error("Width must be a number");if(e<1||e>8)throw new Error("Width must be between 1 and 8");return n(this,a).style.width=e,this}height(e){if(typeof e>"u"&&(e=1),typeof e!="number")throw new Error("Height must be a number");if(e<1||e>8)throw new Error("Height must be between 1 and 8");return n(this,a).style.height=e,this}size(e,t){return typeof e=="string"?this.font(e==="small"?"B":"A"):(typeof t>"u"&&(t=e),this.width(e),this.height(t),this)}font(e){if(n(this,u).embedded)throw new Error("Changing fonts is not supported in table cells or boxes");if(n(this,a).cursor>0)throw new Error("Changing fonts is not supported in the middle of a line");let t,r=e.match(/^[0-9]+x[0-9]+$/);r&&(t=Object.entries(n(this,w).fonts).find(s=>s[1].size==r[0])?.[0]),t=t?.toUpperCase()||"A";let l=n(this,w).fonts[t];return l?(n(this,a).raw(n(this,g).font(t)),n(this,O).font=t,t==="A"?n(this,a).columns=n(this,u).columns:n(this,a).columns=n(this,u).columns/n(this,w).fonts.A.columns*l.columns,this):E(this,z,L).call(this,"This font is not supported by this printer","relaxed")}align(e){if(!["left","center","right"].includes(e))throw new Error("Unknown alignment");return n(this,a).align=e,this}table(e,t){n(this,a).flush();for(let r=0;r<t.length;r++){let l=[],s=0;for(let i=0;i<e.length;i++){let o=new $(Object.assign({},n(this,u),{width:e[i].width,embedded:!0})),d=t[r][i];o.codepage(n(this,R)),o.align(e[i].align),typeof d=="string"&&o.text(d),typeof d=="function"&&d(o);let m=o.commands();s=Math.max(s,m.length),l[i]=m}for(let i=0;i<e.length;i++)if(!(l[i].length>=s))for(let o=l[i].length;o<s;o++){let d="top";typeof e[i].verticalAlign<"u"&&(d=e[i].verticalAlign);let m={commands:[{type:"space",size:e[i].width}],height:1};d=="bottom"?l[i].unshift(m):l[i].push(m)}for(let i=0;i<s;i++){for(let o=0;o<e.length;o++)typeof e[o].marginLeft<"u"&&n(this,a).space(e[o].marginLeft||0),n(this,a).add(l[o][i].commands,e[o].width),typeof e[o].marginRight<"u"&&n(this,a).space(e[o].marginRight||0);n(this,a).flush()}}return this}rule(e){return e=Object.assign({style:"single",width:n(this,u).columns||10},e||{}),n(this,a).flush(),n(this,a).text((e.style==="double"?"\u2550":"\u2500").repeat(e.width),"cp437"),n(this,a).flush(),this}box(e,t){if(e=Object.assign({style:"single",width:n(this,u).columns,marginLeft:0,marginRight:0,paddingLeft:0,paddingRight:0},e||{}),e.width+e.marginLeft+e.marginRight>n(this,u).columns)throw new Error("Box is too wide");let r=[];e.style=="single"?r=["\u250C","\u2510","\u2514","\u2518","\u2500","\u2502"]:e.style=="double"&&(r=["\u2554","\u2557","\u255A","\u255D","\u2550","\u2551"]);let l=new $(Object.assign({},n(this,u),{width:e.width-(e.style=="none"?0:2)-e.paddingLeft-e.paddingRight,embedded:!0}));l.codepage(n(this,R)),l.align(e.align||"left"),typeof t=="function"&&t(l),typeof t=="string"&&l.text(t);let s=l.commands();n(this,a).flush(),e.style!="none"&&(n(this,a).space(e.marginLeft),n(this,a).text(r[0],"cp437"),n(this,a).text(r[4].repeat(e.width-2),"cp437"),n(this,a).text(r[1],"cp437"),n(this,a).space(e.marginRight),n(this,a).flush());for(let i=0;i<s.length;i++)n(this,a).space(e.marginLeft),e.style!="none"&&(n(this,a).style.height=s[i].height,n(this,a).text(r[5],"cp437"),n(this,a).style.height=1),n(this,a).space(e.paddingLeft),n(this,a).add(s[i].commands,e.width-(e.style=="none"?0:2)-e.paddingLeft-e.paddingRight),n(this,a).space(e.paddingRight),e.style!="none"&&(n(this,a).style.height=s[i].height,n(this,a).text(r[5],"cp437"),n(this,a).style.height=1),n(this,a).space(e.marginRight),n(this,a).flush();return e.style!="none"&&(n(this,a).space(e.marginLeft),n(this,a).text(r[2],"cp437"),n(this,a).text(r[4].repeat(e.width-2),"cp437"),n(this,a).text(r[3],"cp437"),n(this,a).space(e.marginRight),n(this,a).flush()),this}barcode(e,t,r){let l={height:60,width:2,text:!1};if(typeof r=="object"&&(l=Object.assign(l,r)),typeof r=="number"&&(l.height=r),n(this,u).embedded)throw new Error("Barcodes are not supported in table cells or boxes");return n(this,w).barcodes.supported===!1?E(this,z,L).call(this,"Barcodes are not supported by this printer","relaxed"):typeof t=="string"&&!n(this,w).barcodes.symbologies.includes(t)?E(this,z,L).call(this,`Symbology '${t}' not supported by this printer`,"relaxed"):(n(this,a).flush({forceFlush:!0,ignoreAlignment:!0}),n(this,a).align!=="left"&&n(this,a).raw(n(this,g).align(n(this,a).align)),n(this,a).raw(n(this,g).barcode(e,t,l)),n(this,a).align!=="left"&&n(this,a).raw(n(this,g).align("left")),n(this,a).flush({forceFlush:!0,ignoreAlignment:!0}),this)}qrcode(e,t,r,l){let s={model:2,size:6,errorlevel:"m"};if(typeof t=="object"&&(s=Object.assign(s,t)),typeof t=="number"&&(s.model=t),typeof r=="number"&&(s.size=r),typeof l=="string"&&(s.errorlevel=l),n(this,u).embedded)throw new Error("QR codes are not supported in table cells or boxes");return n(this,w).qrcode.supported===!1?E(this,z,L).call(this,"QR codes are not supported by this printer","relaxed"):s.model&&!n(this,w).qrcode.models.includes(String(s.model))?E(this,z,L).call(this,"QR code model is not supported by this printer","relaxed"):(n(this,a).flush({forceFlush:!0,ignoreAlignment:!0}),n(this,a).align!=="left"&&n(this,a).raw(n(this,g).align(n(this,a).align)),n(this,a).raw(n(this,g).qrcode(e,s)),n(this,a).align!=="left"&&n(this,a).raw(n(this,g).align("left")),n(this,a).flush({forceFlush:!0,ignoreAlignment:!0}),this)}pdf417(e,t){if(t=Object.assign({width:3,height:3,columns:0,rows:0,errorlevel:1,truncated:!1},t||{}),n(this,u).embedded)throw new Error("PDF417 codes are not supported in table cells or boxes");return n(this,w).pdf417.supported===!1?typeof n(this,w).pdf417.fallback=="object"?this.barcode(e,n(this,w).pdf417.fallback.symbology):E(this,z,L).call(this,"PDF417 codes are not supported by this printer","relaxed"):(n(this,a).flush({forceFlush:!0,ignoreAlignment:!0}),n(this,a).align!=="left"&&n(this,a).raw(n(this,g).align(n(this,a).align)),n(this,a).raw(n(this,g).pdf417(e,t)),n(this,a).align!=="left"&&n(this,a).raw(n(this,g).align("left")),n(this,a).flush({forceFlush:!0,ignoreAlignment:!0}),this)}image(e,t,r,l,s){if(n(this,u).embedded)throw new Error("Images are not supported in table cells or boxes");if(t%8!==0)throw new Error("Width must be a multiple of 8");if(r%8!==0)throw new Error("Height must be a multiple of 8");typeof l>"u"&&(l="threshold"),typeof s>"u"&&(s=128);let i=e.constructor.name,o;if(i.endsWith("Element")&&(o="element"),i=="ImageData"&&(o="imagedata"),i=="Canvas"&&typeof e.getContext<"u"&&(o="node-canvas"),i=="Image"&&(o="node-canvas-image"),i=="Image"&&typeof e.frames<"u"&&(o="node-read-image"),i=="Object"&&e.data&&e.info&&(o="node-sharp"),i=="View3duint8"&&e.data&&e.shape&&(o="ndarray"),i=="Object"&&e.data&&e.width&&e.height&&(o="object"),!o)throw new Error("Could not determine the type of image input");let d;if(o=="element"){let m=document.createElement("canvas");m.width=t,m.height=r;let c=m.getContext("2d");if(c)c.drawImage(e,0,0,t,r),d=c.getImageData(0,0,t,r);else throw new Error("Failed to get 2D rendering context")}if(o=="node-canvas"&&(d=e.getContext("2d").getImageData(0,0,e.width,e.height)),o=="node-canvas-image"){if(typeof n(this,u).createCanvas!="function")throw new Error("Canvas is not supported in this environment, specify a createCanvas function in the options");let c=n(this,u).createCanvas(t,r).getContext("2d");c.drawImage(e,0,0,t,r),d=c.getImageData(0,0,t,r)}if(o=="node-read-image"&&(d=new H(e.width,e.height),d.data.set(e.frames[0].data)),o=="node-sharp"&&(d=new H(e.info.width,e.info.height),d.data.set(e.data)),o=="ndarray"&&(d=new H(e.shape[0],e.shape[1]),d.data.set(e.data)),o=="object"&&(d=new H(e.width,e.height),d.data.set(e.data)),o=="imagedata"&&(d=e),!d)throw new Error("Image could not be loaded");if((t!==d.width||r!==d.height)&&(d=Be(d,t,r,"bilinear-interpolation")),t!==d.width||r!==d.height)throw new Error("Image could not be resized");switch(d=Pe.flatten(d,[255,255,255]),l){case"threshold":d=U.threshold(d,s);break;case"bayer":d=U.bayer(d,s);break;case"floydsteinberg":d=U.floydsteinberg(d);break;case"atkinson":d=U.atkinson(d);break}return n(this,a).flush({forceFlush:!0,ignoreAlignment:!0}),n(this,a).align!=="left"&&n(this,a).raw(n(this,g).align(n(this,a).align)),n(this,a).raw(n(this,g).image(d,t,r,n(this,u).imageMode)),n(this,a).align!=="left"&&n(this,a).raw(n(this,g).align("left")),n(this,a).flush({forceFlush:!0,ignoreAlignment:!0}),this}cut(e){if(n(this,u).embedded)throw new Error("Cut is not supported in table cells or boxes");for(let t=0;t<n(this,u).feedBeforeCut;t++)n(this,a).flush({forceNewline:!0});return n(this,a).flush({forceFlush:!0,ignoreAlignment:!0}),n(this,a).raw(n(this,g).cut(e)),n(this,a).flush({forceFlush:!0,ignoreAlignment:!0}),this}pulse(e,t,r){if(n(this,u).embedded)throw new Error("Pulse is not supported in table cells or boxes");return n(this,a).flush({forceFlush:!0,ignoreAlignment:!0}),n(this,a).raw(n(this,g).pulse(e,t,r)),n(this,a).flush({forceFlush:!0,ignoreAlignment:!0}),this}raw(e){return n(this,a).raw(e),this}commands(){n(this,u).autoFlush&&!n(this,u).embedded&&n(this,a).raw(n(this,g).flush());let e=[],t=n(this,a).fetch({forceFlush:!0,ignoreAlignment:!0});for(t.length&&n(this,q).push(t);n(this,q).length;){let r=n(this,q).shift(),l=r.filter(s=>s.type==="style"&&s.property==="size").map(s=>s.value.height).reduce((s,i)=>Math.max(s,i),1);n(this,u).debug&&console.log("|"+r.filter(s=>s.type==="text").map(s=>s.value).join("")+"|",l),e.push({commands:r,height:l})}return n(this,u).debug&&console.log("commands",e),E(this,z,le).call(this),e}encode(){let e=this.commands(),t=[];for(let r of e){for(let l of r.commands)l.type==="raw"&&t.push(l.value),l.type==="text"&&t.push(E(this,z,ye).call(this,l.value,l.codepage??"auto")),l.type==="style"&&t.push(E(this,z,we).call(this,l.property,l.value));n(this,u).newline===`
\r`&&t.push([10,13]),n(this,u).newline===`
`&&t.push([10])}return Uint8Array.from(t.flat())}static get printerModels(){return Object.entries(se).map(e=>({id:e[0],name:e[1].vendor+" "+e[1].model}))}get columns(){return n(this,a).columns}get language(){return n(this,u).language}get printerCapabilities(){return n(this,w)}};u=new WeakMap,q=new WeakMap,g=new WeakMap,a=new WeakMap,w=new WeakMap,T=new WeakMap,N=new WeakMap,R=new WeakMap,O=new WeakMap,z=new WeakSet,le=function(){h(this,q,[]),h(this,R,n(this,u).language=="esc-pos"?"cp437":"star/standard"),n(this,O).codepage=0,n(this,O).font="A"},we=function(e,t){return e==="bold"?n(this,g).bold(t):e==="underline"?n(this,g).underline(t):e==="italic"?n(this,g).italic(t):e==="invert"?n(this,g).invert(t):e==="size"?n(this,g).size(t.width,t.height):[]},ye=function(e,t){if(t!=="auto"){let s=re.encode(e,t);return n(this,O).codepage!=n(this,T)[t]?(n(this,O).codepage=n(this,T)[t],[...n(this,g).codepage(n(this,T)[t]),...s]):[...s]}let r=re.autoEncode(e,n(this,N)),l=[];for(let s of r)n(this,O).codepage=n(this,T)[s.codepage],l.push(...n(this,g).codepage(n(this,T)[s.codepage]),...s.bytes);return l},L=function(e,t){if(t==="strict"||n(this,u).errors==="strict")throw new Error(e);return console.warn(e),this};var ie=$,tt=ie;export{tt as default};
//# sourceMappingURL=receipt-printer-encoder.esm.js.map